{
  "version": "1",
  "metadata": {
    "marimo_version": "0.17.7"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "b262ef5e79c5177b8237da3f18982d2d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"fase-2-feature-engineering-objetivo-stock-disponible\">Fase 2: Feature Engineering (Objetivo: Stock Disponible)</h1>\n<span class=\"paragraph\">Notebook para la transformaci\u00f3n de <code>dataset.csv</code> en un dataset\nlisto para modelado, con el objetivo de predecir <code>quantity_available</code>.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "68239075e6b8279ca00b3fb5708cdf30",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"diccionario-de-datos-del-dataset-original\">Diccionario de Datos del Dataset Original</h2>\n<span class=\"paragraph\">Basado en la estructura del dataset, este diccionario de datos describe cada columna:</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "06bb05a8778cd09cc349217c76eef8e9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"1-carga-y-preparacion-base\">1. Carga y Preparaci\u00f3n Base</h2>\n<ol>\n<li>Cargamos el dataset.</li>\n<li>Convertimos las columnas de fecha a <code>datetime</code>.</li>\n<li><strong>Ordenamos el dataset</strong> por producto (<code>product_sku</code>) y\n    fecha (<code>created_at</code>). Esto es <strong>fundamental</strong> para\n    que los c\u00e1lculos de lags y medias m\u00f3viles sean correctos.</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "5b70a03935aa6b0110f6afc72e039516",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Justificaci\u00f3n:</strong></span>\n<ul>\n<li>Cargamos los datos, convertimos las fechas y ordenamos por \u00b4product_sku\u00b4 y created_at. Al ordenar, nos aseguramos de que todos los c\u00e1lculos de tiempo (lags, medias) ocurran dentro del hilo de cada producto.</li>\n<li>Con  \u00b4.sort_values()\u00b4 aseguramos que los datos de cada producto sean una \"l\u00ednea de tiempo\" individual. Sin esto, el lag_1 (valor de ayer) tomar\u00eda el valor de un producto totalmente diferente, y el modelo aprender\u00eda mal.</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "df540fb63693adc6c87e2313e0e4cc6d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"2-feature-engineering-variables-temporales\">2. Feature Engineering: Variables Temporales</h2>\n<span class=\"paragraph\">Extraemos componentes de la fecha principal (<code>created_at</code>) para que\nel modelo pueda aprender patrones estacionales\n(ej. \"los lunes se mueve m\u00e1s stock\", \"en verano baja la demanda\").</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "52cf91f2882c61398ea6d5a1ac2eae0a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Explicaci\u00f3n:</strong> En esta parte creamos dia_de_la_semana, estaci\u00f3n, trimestre...</span>\n<ul>\n<li>Nuestro modelo de ML no entiende \"Lunes\" o \"True\". Al convertir todo a n\u00fameros (dia_de_la_semana=0, es_feriado=1), le damos un contexto como un calendario</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "227401e4963516567ef2ba25a091e9d4",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"3-feature-engineering-lags-variables-sinteticas\">3. Feature Engineering: Lags (Variables Sint\u00e9ticas)</h2>\n<span class=\"paragraph\">Creamos variables \"lag\" (retrasadas) de nuestra <code>VAR_OBJETIVO</code>.\nEsto es <strong>lo m\u00e1s importante</strong> para predicci\u00f3n: le decimos al modelo\ncu\u00e1l era el stock disponible \"ayer\", \"la semana pasada\" y \"el mes pasado\".</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "4cee715ccd669fc310acc995d9ebe038",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Explicaci\u00f3n:</strong></span>\n<ul>\n<li>\n<span class=\"paragraph\">Creamos lag_1, lag_7, lag_30 usando quantity_available. Que son la MEMORIA del modelo</span>\n<ol>\n<li>lag_1: Le da al modelo memoria a corto plazo.</li>\n<li>lag_7: Le da memoria semanal (comparar este lunes con el lunes pasado).</li>\n<li>lag_30: Le da memoria mensual.</li>\n<li>El groupby(ID_PRODUCTO) garantiza que el lag_1 de la \"Barra Cereal Choco\" sea el de la \"Barra Cereal Choco\" de ayer, y no el de \"Agua Mineral\".</li>\n</ol>\n</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "nWHF",
      "code_hash": "8108bdfc79abf739e8365203e1a084d2",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"4-feature-engineering-historicas-y-estadisticas\">4. Feature Engineering: Hist\u00f3ricas y Estad\u00edsticas</h2>\n<span class=\"paragraph\">Calculamos estad\u00edsticas m\u00f3viles para capturar la <strong>tendencia</strong> y\nla <strong>volatilidad</strong> del stock.</span>\n<ul>\n<li><strong>Medias M\u00f3viles:</strong> Suavizan el ruido diario.</li>\n<li><strong>Media Exponencial (EWMA):</strong> Da m\u00e1s peso a los datos recientes.</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "59459ceebbaf859fae8b6e18c265de8a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Justificaci\u00f3n:</strong></span>\n<ul>\n<li>Creamos media_movil_7d, media_movil_30d y media_movil_exponencial.</li>\n<li>Dado que el stock diario puede ser \"ruidoso\" (subir y bajar mucho). Las medias m\u00f3viles suavizan este ruido y le muestran al modelo la tendencia general.</li>\n<li>Esto le da al modelo el CONTEXTO DE TENDENCIA Y VOLATILIDAD. El lag_1 le dice d\u00f3nde estaba ayer, pero la media_movil_30d le dice si esa cifra es \"normal\" o si est\u00e1 muy por encima/debajo de la tendencia del mes. La std_movil_30d (desviaci\u00f3n est\u00e1ndar) le dice qu\u00e9 tan estable o no es el stock de ese producto.</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ROlb",
      "code_hash": "ee9f24261378a64e05e916ad80d0e3b5",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"5-feature-engineering-variables-sinteticas\">5. Feature Engineering: Variables Sint\u00e9ticas</h2>\n<span class=\"paragraph\">Creamos variables de negocio combinando otras.\nEstas variables capturan conceptos m\u00e1s complejos.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "qnkX",
      "code_hash": "f0a6899134b4d76026c60c3c33bd2ce5",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Explicaci\u00f3n:</strong></span>\n<ul>\n<li>Creamos tendencia_stock (media corta vs. larga), anomalia_stock (qu\u00e9 tan raro es el valor de hoy), ratio_reservado_disponible (qu\u00e9 tan estresado est\u00e1 el stock) y ahora rotacion_estimada_30d (qu\u00e9 tan r\u00e1pido se mueve).</li>\n<li>Estas son \"features de inteligencia de negocio\". Son ATAJOS para el modelo. En lugar de que el modelo intente descubrir que restar la media de 7 d\u00edas y la de 30 d\u00edas es importante, se lo damos directamente (tendencia_stock). Le damos el \"nivel de estr\u00e9s\" y el \"nivel de velocidad\" pre-calculados.</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Vxnm",
      "code_hash": "b8f222cf25dc92afa10a38ee7e6c10d0",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"nota-sobre-rotacion_promedio_mensual\">Nota sobre <code>rotacion_promedio_mensual</code></h3>\n<span class=\"paragraph\">No pudimos calcular la rotaci\u00f3n <em>financiera</em> (que usa Costo de Ventas),\npero s\u00ed calculamos la <strong>rotaci\u00f3n en unidades</strong> (<code>rotacion_estimada_30d</code>)\nusando <code>average_daily_usage</code> y <code>media_movil_30d</code>.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "DnEU",
      "code_hash": "b942d0ea5f4d6ba7fd69fdb06eaa568d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"6-limpieza-final-y-guardado\">6. Limpieza Final y Guardado</h2>\n<span class=\"paragraph\">Los c\u00e1lculos de lags y medias m\u00f3viles crean valores <code>NaN</code> (Nulos)\nal principio de la serie de cada producto (ej. los primeros 30 d\u00edas).</span>\n<span class=\"paragraph\"><strong>Eliminamos estas filas incompletas</strong> para que el modelo entrene\nsolo con datos 100% completos.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Pvdt",
      "code_hash": "ed5aa57d349138750a3a28133e9fafeb",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"conclusiones-de-la-fase-1-feature-engineering\">Conclusiones de la Fase 1: Feature Engineering</h2>\n<span class=\"paragraph\">En esta fase, hemos transformado exitosamente el <code>dataset.csv</code> original en un\n    dataset 100% optimizado para Machine Learning. El objetivo ya no es\n    la exploraci\u00f3n (EDA), sino la <strong>preparaci\u00f3n para la predicci\u00f3n</strong>.</span>\n<span class=\"paragraph\"><strong>Puntos Principales:</strong></span>\n<span class=\"paragraph\"><strong>1. Dataset 100% Num\u00e9rico y Limpio:</strong>\n    El resultado final (<code>dataset_processed_advanced.csv</code>) tiene <strong>7,050 filas y 41 columnas</strong>,\n    sin valores nulos y en un formato puramente num\u00e9rico. Est\u00e1 listo para ser\n    consumido directamente por un modelo.</span>\n<span class=\"paragraph\"><strong>2. Creaci\u00f3n de \"Memoria\" (Lags):</strong>\n    A\u00f1adimos <code>lag_1</code>, <code>lag_7</code> y <code>lag_30</code>. Estas son las variables m\u00e1s importantes,\n    ya que le dan al modelo la \"memoria\" de d\u00f3nde estaba el stock ayer, la semana\n    pasada y el mes pasado.</span>\n<span class=\"paragraph\"><strong>3. Creaci\u00f3n de \"Contexto\" (Medias M\u00f3viles y Estad\u00edsticas):</strong>\n    No solo le dijimos al modelo <em>d\u00f3nde</em> estaba el stock (lags), sino que le dimos\n    <em>contexto</em>. Variables como <code>media_movil_30d</code> (tendencia estable),\n    <code>std_movil_30d</code> (volatilidad) y <code>anomalia_stock</code> (qu\u00e9 tan \"raro\" es el valor de hoy)\n    le permiten al modelo tomar decisiones mucho m\u00e1s inteligentes.</span>\n<span class=\"paragraph\"><strong>4. Creaci\u00f3n de \"Inteligencia de Negocio\" (Variables Sint\u00e9ticas):</strong>\n    Creamos variables que capturan conceptos de negocio complejos en un solo n\u00famero.\n    Las m\u00e1s importantes son:</span>\n<span class=\"paragraph\">- <code>rotacion_estimada_30d</code>: Le dice al modelo qu\u00e9 tan <em>r\u00e1pido</em> se mueve este producto.</span>\n<span class=\"paragraph\">- <code>ratio_reservado_disponible</code>: Mide el \"estr\u00e9s\" o la presi\u00f3n sobre el stock disponible.</span>\n<span class=\"paragraph\">- <code>tendencia_stock</code>: Indica si el stock est\u00e1 creciendo o disminuyendo (media corta vs. larga).</span>\n<span class=\"paragraph\"><strong>5. El Intercambio: \"Calidad sobre Cantidad\"</strong>\n    Decidimos conscientemente eliminar <strong>450 filas</strong> (el 6% de los datos).\n    Este \"costo\" fue necesario para poder calcular los features de 30 d\u00edas\n    (como <code>lag_30</code> y <code>media_movil_30d</code>).</span>\n<span class=\"paragraph\"><strong>\u00bfPor qu\u00e9 fue una buena decisi\u00f3n?</strong> Sacrificamos el 6% de nuestros peores datos\n    (el \"arranque en fr\u00edo\" de cada producto, que no ten\u00eda historia) para hacer\n    que el 94% restante de los datos sea m\u00e1s inteligente.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "bc07401ca9be7fa3cdcea5548516f9f2",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Librer\u00edas importadas correctamente.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "367abb9dfda22c1b1eb30741e43c17d4",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='bkHC-0' random-id='2fd0de88-889c-4409-1077-cca524a74327'><marimo-dataframe data-initial-value='{&quot;transforms&quot;:[]}' data-label='null' data-columns='[[&quot;Variable&quot;,&quot;string&quot;,&quot;object&quot;],[&quot;Tipo de Dato&quot;,&quot;string&quot;,&quot;object&quot;],[&quot;Descripci\u00f3n&quot;,&quot;string&quot;,&quot;object&quot;]]' data-dataframe-name='&quot;df_diccionario_original&quot;' data-total='37' data-page-size='5' data-show-download='true'></marimo-dataframe></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "9e5719e40b34a4cb1e677ce9fe572871",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Dataset ordenado por 'product_sku' y 'created_at'.\nVariable Objetivo para lags/medias: 'quantity_available'\n<class 'pandas.core.frame.DataFrame'>\nIndex: 7500 entries, 500 to 7499\nData columns (total 37 columns):\n #   Column                  Non-Null Count  Dtype         \n---  ------                  --------------  -----         \n 0   id                      7500 non-null   int64         \n 1   created_at              7500 non-null   datetime64[ns]\n 2   product_id              7500 non-null   int64         \n 3   product_name            7500 non-null   object        \n 4   product_sku             7500 non-null   object        \n 5   supplier_id             7500 non-null   int64         \n 6   supplier_name           7500 non-null   object        \n 7   prioridad_proveedor     7500 non-null   int64         \n 8   quantity_on_hand        7500 non-null   int64         \n 9   quantity_reserved       7500 non-null   int64         \n 10  quantity_available      7500 non-null   int64         \n 11  minimum_stock_level     7500 non-null   int64         \n 12  reorder_point           7500 non-null   int64         \n 13  optimal_stock_level     7500 non-null   int64         \n 14  reorder_quantity        7500 non-null   int64         \n 15  average_daily_usage     7500 non-null   float64       \n 16  last_order_date         7500 non-null   datetime64[ns]\n 17  last_stock_count_date   7500 non-null   datetime64[ns]\n 18  unit_cost               7500 non-null   float64       \n 19  total_value             7500 non-null   float64       \n 20  expiration_date         7500 non-null   datetime64[ns]\n 21  batch_number            7500 non-null   object        \n 22  warehouse_location      7500 non-null   object        \n 23  shelf_location          7500 non-null   object        \n 24  region_almacen          7500 non-null   object        \n 25  stock_status            7500 non-null   object        \n 26  is_active               7500 non-null   int64         \n 27  last_updated_at         7500 non-null   datetime64[ns]\n 28  created_by_id           7500 non-null   int64         \n 29  record_sequence_number  7500 non-null   int64         \n 30  categoria_producto      7500 non-null   object        \n 31  subcategoria_producto   7500 non-null   object        \n 32  anio                    7500 non-null   int64         \n 33  mes                     7500 non-null   int64         \n 34  vacaciones_o_no         7500 non-null   bool          \n 35  es_feriado              7500 non-null   bool          \n 36  temporada_alta          7500 non-null   bool          \ndtypes: bool(3), datetime64[ns](5), float64(3), int64(16), object(10)\nmemory usage: 2.0+ MB\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "RGSE",
      "code_hash": "6d4dfb7e4f9f4f73f6c88b97c91794ef",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Variables temporales nuevas creadas (semana, dia, trimestre, estacion).\nVariables booleanas existentes (vacaciones, feriado, temporada_alta) convertidas a 0/1.\n\n--- df.info() despu\u00e9s de procesar variables temporales ---\n<class 'pandas.core.frame.DataFrame'>\nIndex: 7500 entries, 500 to 7499\nData columns (total 43 columns):\n #   Column                  Non-Null Count  Dtype         \n---  ------                  --------------  -----         \n 0   id                      7500 non-null   int64         \n 1   created_at              7500 non-null   datetime64[ns]\n 2   product_id              7500 non-null   int64         \n 3   product_name            7500 non-null   object        \n 4   product_sku             7500 non-null   object        \n 5   supplier_id             7500 non-null   int64         \n 6   supplier_name           7500 non-null   object        \n 7   prioridad_proveedor     7500 non-null   int64         \n 8   quantity_on_hand        7500 non-null   int64         \n 9   quantity_reserved       7500 non-null   int64         \n 10  quantity_available      7500 non-null   int64         \n 11  minimum_stock_level     7500 non-null   int64         \n 12  reorder_point           7500 non-null   int64         \n 13  optimal_stock_level     7500 non-null   int64         \n 14  reorder_quantity        7500 non-null   int64         \n 15  average_daily_usage     7500 non-null   float64       \n 16  last_order_date         7500 non-null   datetime64[ns]\n 17  last_stock_count_date   7500 non-null   datetime64[ns]\n 18  unit_cost               7500 non-null   float64       \n 19  total_value             7500 non-null   float64       \n 20  expiration_date         7500 non-null   datetime64[ns]\n 21  batch_number            7500 non-null   object        \n 22  warehouse_location      7500 non-null   object        \n 23  shelf_location          7500 non-null   object        \n 24  region_almacen          7500 non-null   object        \n 25  stock_status            7500 non-null   object        \n 26  is_active               7500 non-null   int64         \n 27  last_updated_at         7500 non-null   datetime64[ns]\n 28  created_by_id           7500 non-null   int64         \n 29  record_sequence_number  7500 non-null   int64         \n 30  categoria_producto      7500 non-null   object        \n 31  subcategoria_producto   7500 non-null   object        \n 32  anio                    7500 non-null   int64         \n 33  mes                     7500 non-null   int64         \n 34  vacaciones_o_no         7500 non-null   int64         \n 35  es_feriado              7500 non-null   int64         \n 36  temporada_alta          7500 non-null   int64         \n 37  semana_del_anio         7500 non-null   UInt32        \n 38  dia_del_mes             7500 non-null   int32         \n 39  dia_de_la_semana        7500 non-null   int32         \n 40  es_fin_de_semana        7500 non-null   int64         \n 41  trimestre               7500 non-null   int32         \n 42  estacion                7500 non-null   object        \ndtypes: UInt32(1), datetime64[ns](5), float64(3), int32(3), int64(20), object(11)\nmemory usage: 2.4+ MB\n\n--- df.head().T despu\u00e9s de procesar variables temporales ---\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                                500                  501                  502  \\\nproduct_sku                 BCA-115              BCA-115              BCA-115   \ncreated_at      2024-01-01 00:00:00  2024-01-02 00:00:00  2024-01-03 00:00:00   \nmes                               1                    1                    1   \nestacion                   Invierno             Invierno             Invierno   \nes_feriado                        1                    0                    0   \ntemporada_alta                    1                    1                    1   \n\n                                503                  504  \nproduct_sku                 BCA-115              BCA-115  \ncreated_at      2024-01-04 00:00:00  2024-01-05 00:00:00  \nmes                               1                    1  \nestacion                   Invierno             Invierno  \nes_feriado                        0                    0  \ntemporada_alta                    1                    1  \n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "Hstk",
      "code_hash": "716eda76b88a3009f0b3fb3725121db9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='Hstk-0' random-id='5a068636-d7cb-4522-e1d1-194b7f7ff82e'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;&#92;&quot;:500,&#92;&quot;product_sku&#92;&quot;:&#92;&quot;BCA-115&#92;&quot;,&#92;&quot;created_at&#92;&quot;:&#92;&quot;2024-01-01T00:00:00.000&#92;&quot;,&#92;&quot;quantity_available&#92;&quot;:351,&#92;&quot;lag_1&#92;&quot;:null,&#92;&quot;lag_7&#92;&quot;:null},{&#92;&quot;&#92;&quot;:501,&#92;&quot;product_sku&#92;&quot;:&#92;&quot;BCA-115&#92;&quot;,&#92;&quot;created_at&#92;&quot;:&#92;&quot;2024-01-02T00:00:00.000&#92;&quot;,&#92;&quot;quantity_available&#92;&quot;:342,&#92;&quot;lag_1&#92;&quot;:351.0,&#92;&quot;lag_7&#92;&quot;:null},{&#92;&quot;&#92;&quot;:502,&#92;&quot;product_sku&#92;&quot;:&#92;&quot;BCA-115&#92;&quot;,&#92;&quot;created_at&#92;&quot;:&#92;&quot;2024-01-03T00:00:00.000&#92;&quot;,&#92;&quot;quantity_available&#92;&quot;:333,&#92;&quot;lag_1&#92;&quot;:342.0,&#92;&quot;lag_7&#92;&quot;:null},{&#92;&quot;&#92;&quot;:503,&#92;&quot;product_sku&#92;&quot;:&#92;&quot;BCA-115&#92;&quot;,&#92;&quot;created_at&#92;&quot;:&#92;&quot;2024-01-04T00:00:00.000&#92;&quot;,&#92;&quot;quantity_available&#92;&quot;:324,&#92;&quot;lag_1&#92;&quot;:333.0,&#92;&quot;lag_7&#92;&quot;:null},{&#92;&quot;&#92;&quot;:504,&#92;&quot;product_sku&#92;&quot;:&#92;&quot;BCA-115&#92;&quot;,&#92;&quot;created_at&#92;&quot;:&#92;&quot;2024-01-05T00:00:00.000&#92;&quot;,&#92;&quot;quantity_available&#92;&quot;:319,&#92;&quot;lag_1&#92;&quot;:324.0,&#92;&quot;lag_7&#92;&quot;:null}]&quot;' data-total-rows='5' data-total-columns='5' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;product_sku&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;created_at&quot;,[&quot;datetime&quot;,&quot;datetime64[ns]&quot;]],[&quot;quantity_available&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lag_1&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;lag_7&quot;,[&quot;number&quot;,&quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[&quot;&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Variables Lag (1, 7, 30) creadas para 'quantity_available'.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "ZHCJ",
      "code_hash": "afd6772e9118a404c9cdcfbeaf08d363",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Medias m\u00f3viles (7d, 30d, Exp) y Std (30d) creadas.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "TqIu",
      "code_hash": "87fbb99d8c8930a7d1cff51152ab5fcc",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Variables sint\u00e9ticas (variaci\u00f3n, tendencia, ratios, anomal\u00eda) creadas.\nVariable sint\u00e9tica 'rotacion_estimada_30d' CREADA.\n\n--- df.info() despu\u00e9s de crear variables sint\u00e9ticas ---\n<class 'pandas.core.frame.DataFrame'>\nIndex: 7500 entries, 500 to 7499\nData columns (total 56 columns):\n #   Column                      Non-Null Count  Dtype         \n---  ------                      --------------  -----         \n 0   id                          7500 non-null   int64         \n 1   created_at                  7500 non-null   datetime64[ns]\n 2   product_id                  7500 non-null   int64         \n 3   product_name                7500 non-null   object        \n 4   product_sku                 7500 non-null   object        \n 5   supplier_id                 7500 non-null   int64         \n 6   supplier_name               7500 non-null   object        \n 7   prioridad_proveedor         7500 non-null   int64         \n 8   quantity_on_hand            7500 non-null   int64         \n 9   quantity_reserved           7500 non-null   int64         \n 10  quantity_available          7500 non-null   int64         \n 11  minimum_stock_level         7500 non-null   int64         \n 12  reorder_point               7500 non-null   int64         \n 13  optimal_stock_level         7500 non-null   int64         \n 14  reorder_quantity            7500 non-null   int64         \n 15  average_daily_usage         7500 non-null   float64       \n 16  last_order_date             7500 non-null   datetime64[ns]\n 17  last_stock_count_date       7500 non-null   datetime64[ns]\n 18  unit_cost                   7500 non-null   float64       \n 19  total_value                 7500 non-null   float64       \n 20  expiration_date             7500 non-null   datetime64[ns]\n 21  batch_number                7500 non-null   object        \n 22  warehouse_location          7500 non-null   object        \n 23  shelf_location              7500 non-null   object        \n 24  region_almacen              7500 non-null   object        \n 25  stock_status                7500 non-null   object        \n 26  is_active                   7500 non-null   int64         \n 27  last_updated_at             7500 non-null   datetime64[ns]\n 28  created_by_id               7500 non-null   int64         \n 29  record_sequence_number      7500 non-null   int64         \n 30  categoria_producto          7500 non-null   object        \n 31  subcategoria_producto       7500 non-null   object        \n 32  anio                        7500 non-null   int64         \n 33  mes                         7500 non-null   int64         \n 34  vacaciones_o_no             7500 non-null   int64         \n 35  es_feriado                  7500 non-null   int64         \n 36  temporada_alta              7500 non-null   int64         \n 37  semana_del_anio             7500 non-null   UInt32        \n 38  dia_del_mes                 7500 non-null   int32         \n 39  dia_de_la_semana            7500 non-null   int32         \n 40  es_fin_de_semana            7500 non-null   int64         \n 41  trimestre                   7500 non-null   int32         \n 42  estacion                    7500 non-null   object        \n 43  lag_1                       7485 non-null   float64       \n 44  lag_7                       7395 non-null   float64       \n 45  lag_30                      7050 non-null   float64       \n 46  media_movil_7d              7500 non-null   float64       \n 47  media_movil_30d             7500 non-null   float64       \n 48  media_movil_exponencial     7500 non-null   float64       \n 49  std_movil_30d               7500 non-null   float64       \n 50  variacion_stock_diaria      7485 non-null   float64       \n 51  tendencia_stock             7500 non-null   float64       \n 52  dias_desde_ultimo_pedido    7500 non-null   int64         \n 53  ratio_reservado_disponible  7500 non-null   float64       \n 54  anomalia_stock              7500 non-null   float64       \n 55  rotacion_estimada_30d       7500 non-null   float64       \ndtypes: UInt32(1), datetime64[ns](5), float64(15), int32(3), int64(21), object(11)\nmemory usage: 3.2+ MB\n\n--- df.head().T despu\u00e9s de crear variables sint\u00e9ticas ---\n                                                 500  \\\nid                                                 1   \ncreated_at                       2024-01-01 00:00:00   \nproduct_id                                       115   \nproduct_name                Barra Chocolate Avellana   \nproduct_sku                                  BCA-115   \n...                                              ...   \ntendencia_stock                                0.000   \ndias_desde_ultimo_pedido                           3   \nratio_reservado_disponible                     0.051   \nanomalia_stock                                 0.000   \nrotacion_estimada_30d                          0.940   \n\n                                                 501  \\\nid                                                 2   \ncreated_at                       2024-01-02 00:00:00   \nproduct_id                                       115   \nproduct_name                Barra Chocolate Avellana   \nproduct_sku                                  BCA-115   \n...                                              ...   \ntendencia_stock                                0.000   \ndias_desde_ultimo_pedido                           2   \nratio_reservado_disponible                     0.044   \nanomalia_stock                                -0.707   \nrotacion_estimada_30d                          0.866   \n\n                                                 502  \\\nid                                                 3   \ncreated_at                       2024-01-03 00:00:00   \nproduct_id                                       115   \nproduct_name                Barra Chocolate Avellana   \nproduct_sku                                  BCA-115   \n...                                              ...   \ntendencia_stock                                0.000   \ndias_desde_ultimo_pedido                           3   \nratio_reservado_disponible                     0.060   \nanomalia_stock                                -1.000   \nrotacion_estimada_30d                          0.877   \n\n                                                 503                       504  \nid                                                 4                         5  \ncreated_at                       2024-01-04 00:00:00       2024-01-05 00:00:00  \nproduct_id                                       115                       115  \nproduct_name                Barra Chocolate Avellana  Barra Chocolate Avellana  \nproduct_sku                                  BCA-115                   BCA-115  \n...                                              ...                       ...  \ntendencia_stock                                0.000                     0.000  \ndias_desde_ultimo_pedido                           4                         1  \nratio_reservado_disponible                     0.062                     0.053  \nanomalia_stock                                -1.162                    -1.136  \nrotacion_estimada_30d                          0.889                     0.899  \n\n[56 rows x 5 columns]\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "ulZA",
      "code_hash": "d545533ea78d6d3cad8e71f4e750bfae",
      "outputs": [],
      "console": []
    },
    {
      "id": "ecfG",
      "code_hash": "d2e4ee59bfe0a2fb1fffd65930a0cdd9",
      "outputs": [],
      "console": []
    },
    {
      "id": "ZBYS",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    }
  ]
}