{
  "version": "1",
  "metadata": {
    "marimo_version": "0.17.7"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "4a9cd3938f14eb82d9cb287213e5cf99",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"fase-3-optimizacion-de-hiperparametros-con-grid-search\">Fase 3: Optimizaci\u00f3n de Hiperpar\u00e1metros con Grid Search</h1>\n<span class=\"paragraph\">En esta fase, realizaremos <strong>fine-tuning</strong> del modelo GRU utilizando <strong>Grid Search</strong>.\nEn la <strong>Fase 2</strong> entrenamos un modelo GRU con hiperpar\u00e1metros \"elegidos a ojo\".\nAhora vamos a ser m\u00e1s cient\u00edficos: probaremos <strong>108 combinaciones diferentes</strong>\nde configuraciones para encontrar la <strong>mejor</strong>.</span>\n<h2 id=\"objetivos\">Objetivos:</h2>\n<ol>\n<li>Definir un espacio de b\u00fasqueda de hiperpar\u00e1metros</li>\n<li>Implementar Grid Search manualmente para modelos Keras</li>\n<li>Entrenar m\u00faltiples modelos y comparar resultados</li>\n<li>Registrar todos los experimentos en MLflow</li>\n<li>Seleccionar el mejor modelo basado en m\u00e9tricas de validaci\u00f3n</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "09e3fb8b4690031f8921f6a8baa7e271",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"1-carga-de-datos-procesados\">1. Carga de Datos Procesados</h2>\n<ul>\n<li>Utilizamos el mismo dataset de la Fase 2.</li>\n<li>Las columnas no num\u00e9ricas causan errores en modelos de Machine Learning</li>\n<li>Validamos que los datos est\u00e9n disponibles antes de continuar</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "5271d59c3965b3d9174bb0d031a4805a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"2-escalado-de-datos\">2. Escalado de Datos</h2>\n<span class=\"paragraph\">Normalizamos los datos entre 0 y 1.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "17b6ab203a00cf581022b3d2688faca9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"3-division-cronologica-trainvalidationtest\">3. Divisi\u00f3n Cronol\u00f3gica (Train/Validation/Test)</h2>\n<span class=\"paragraph\"><strong>Mantenemos la misma divisi\u00f3n de la Fase 2 para comparabilidad:</strong></span>\n<ul>\n<li><strong>Train (80%):</strong> Datos hist\u00f3ricos para entrenamiento del modelo</li>\n<li><strong>Validation (10%):</strong> Conjunto para selecci\u00f3n de hiperpar\u00e1metros en Grid Search</li>\n<li><strong>Test (10%):</strong> Evaluaci\u00f3n final imparcial (nunca visto durante optimizaci\u00f3n)</li>\n</ul>\n<span class=\"paragraph\"><strong>\u00bfPor qu\u00e9 es crucial mantener la misma divisi\u00f3n?</strong></span>\n<ol>\n<li><strong>Comparabilidad:</strong> Permite comparar directamente Baseline vs Grid Search</li>\n<li><strong>Validez:</strong> El test set debe ser id\u00e9ntico en ambos experimentos</li>\n<li><strong>Integridad:</strong> Evita \"data leakage\" (filtraci\u00f3n de informaci\u00f3n)</li>\n</ol>\n<span class=\"paragraph\"><strong>Flujo de datos:</strong>\n<div class=\"language-ini codehilite\"><pre><span></span><code><span class=\"k\">[\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Train (80%) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500][Val(10%)][Test(10%)]</span>\n<span class=\"w\">                                  </span><span class=\"na\">\u2193           \u2193</span>\n<span class=\"w\">                          </span><span class=\"na\">Grid Search    Evaluaci\u00f3n</span>\n<span class=\"w\">                          </span><span class=\"na\">Optimizaci\u00f3n      Final</span>\n</code></pre></div></span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "6d3211303334bef4ec48f3d628b71d89",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"4-creacion-de-secuencias\">4. Creaci\u00f3n de Secuencias</h2>\n<span class=\"paragraph\">Convertimos los datos en secuencias temporales para el modelo GRU.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "c52678cb37d1134ff138efa837214679",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"5-definicion-del-espacio-de-hiperparametros\">5. Definici\u00f3n del Espacio de Hiperpar\u00e1metros</h2>\n<span class=\"paragraph\">Definimos los hiperpar\u00e1metros a explorar en nuestro Grid Search:</span>\n<table>\n<thead>\n<tr>\n<th>Hiperpar\u00e1metro</th>\n<th>Valores a Probar</th>\n<th>Descripci\u00f3n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>units</strong></td>\n<td>[32, 64, 128]</td>\n<td>Neuronas en la capa GRU</td>\n</tr>\n<tr>\n<td><strong>dropout</strong></td>\n<td>[0.1, 0.2, 0.3]</td>\n<td>Tasa de regularizaci\u00f3n</td>\n</tr>\n<tr>\n<td><strong>learning_rate</strong></td>\n<td>[0.001, 0.0005, 0.0001]</td>\n<td>Velocidad de aprendizaje</td>\n</tr>\n<tr>\n<td><strong>batch_size</strong></td>\n<td>[32, 64]</td>\n<td>Tama\u00f1o del lote</td>\n</tr>\n<tr>\n<td><strong>layer_type</strong></td>\n<td>['GRU', 'LSTM']</td>\n<td>Tipo de capa recurrente</td>\n</tr>\n</tbody>\n</table>\n<span class=\"paragraph\"><strong>Total de combinaciones:</strong> 3 \u00d7 3 \u00d7 3 \u00d7 2 \u00d7 2 = <strong>108 modelos</strong></span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "868ef06ccc597ac9a33086478918fa16",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"6-funcion-para-construir-modelos\">6. Funci\u00f3n para Construir Modelos</h2>\n<span class=\"paragraph\">Creamos una funci\u00f3n que construye un modelo GRU/LSTM con los hiperpar\u00e1metros especificados.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "46e7ababe3a8370c23e9b4303d59198d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"7-grid-search-manual-con-mlflow\">7. Grid Search Manual con MLflow</h2>\n<span class=\"paragraph\">Implementamos el Grid Search manualmente, entrenando cada combinaci\u00f3n\ny registrando los resultados en MLflow.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ROlb",
      "code_hash": "c6e828e45f67661e15784de3ab8c3f18",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"8-analisis-de-resultados-del-grid-search\">8. An\u00e1lisis de Resultados del Grid Search</h2>\n<span class=\"paragraph\">Analizamos y visualizamos los resultados de todas las combinaciones probadas.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Vxnm",
      "code_hash": "2af8e155acfdfa9108b80107c90cf209",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"9-visualizacion-de-resultados\">9. Visualizaci\u00f3n de Resultados</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ecfG",
      "code_hash": "607410b5c18aac4c5c5af63c24f4e70c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"10-evaluacion-del-mejor-modelo-en-test-set\">10. Evaluaci\u00f3n del Mejor Modelo en Test Set</h2>\n<span class=\"paragraph\">Cargamos el mejor modelo y lo evaluamos en el conjunto de prueba (el \"examen final\").</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "aLJB",
      "code_hash": "3b61fc06c2ea83df5873119d456b8bdf",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"11-comparacion-modelo-baseline-vs-mejor-modelo\">11. Comparaci\u00f3n: Modelo Baseline vs Mejor Modelo</h2>\n<span class=\"paragraph\">Comparamos el rendimiento del modelo original (Fase 2) con el mejor modelo encontrado en el Grid Search.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "xXTn",
      "code_hash": "c037ed6c2166fbc47cb05125ee12095c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"12-conclusiones\">12. Conclusiones</h2>\n<h3 id=\"logros-de-la-fase-3\">Logros de la Fase 3:</h3>\n<ol>\n<li><strong>Grid Search Exitoso</strong>: Evaluamos 108 combinaciones de hiperpar\u00e1metros de forma sistem\u00e1tica</li>\n<li><strong>Optimizaci\u00f3n Documentada</strong>: Todos los experimentos quedaron registrados en MLflow para trazabilidad</li>\n<li><strong>Modelo Mejorado</strong>: Encontramos la configuraci\u00f3n \u00f3ptima que maximiza la precisi\u00f3n de predicci\u00f3n</li>\n<li><strong>An\u00e1lisis Exhaustivo</strong>: Identificamos patrones sobre qu\u00e9 hiperpar\u00e1metros tienen mayor impacto</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "AjVT",
      "code_hash": "5312b2981b4458d6bce071aa5ee6e856",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"13-acceso-a-mlflow-ui\">13. Acceso a MLflow UI</h2>\n<span class=\"paragraph\">Para visualizar todos los experimentos y comparar modelos:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code><span class=\"c1\"># En tu terminal, desde la carpeta del proyecto:</span>\nmlflow<span class=\"w\"> </span>ui\n</code></pre></div>\n<span class=\"paragraph\">Luego abre en tu navegador: <code>http://127.0.0.1:5000</code></span>\n<h3 id=\"que-podras-ver-en-mlflow\">Qu\u00e9 podr\u00e1s ver en MLflow:</h3>\n<ul>\n<li><strong>Experiments</strong>: Lista de todos los 108+ experimentos ejecutados</li>\n<li><strong>Compare Runs</strong>: Comparaci\u00f3n visual de m\u00e9tricas entre modelos</li>\n<li><strong>Artifacts</strong>: Gr\u00e1ficos y modelos guardados</li>\n<li><strong>Parameters</strong>: Hiperpar\u00e1metros de cada experimento</li>\n<li><strong>Metrics</strong>: Curvas de aprendizaje y m\u00e9tricas finales</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "0a674c88e2c19906802d48085bb43449",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025-11-20 12:31:47.690594: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025-11-20 12:31:50.581479: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": " Todas las librer\u00edas para Grid Search y MLflow han sido importadas.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "b54e8433ea9350a175f92d15e4fd5258",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Dataset cargado exitosamente. Forma: (7050, 40)\n\u2713 Columnas no num\u00e9ricas eliminadas: ['product_sku', 'region_almacen']\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "PKri",
      "code_hash": "8dfc3953f32593e3f0d3b0869558730c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Datos escalados a [0, 1].\nForma de X_scaled: (7050, 36)\nForma de y_scaled: (7050, 1)\nN\u00famero de features: 36\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "SFPL",
      "code_hash": "1cd85d566fe98131970ef76fc6024250",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": " Divisi\u00f3n 80/10/10 completada:\n    Total: 7,050 muestras\n    Train: 5,640 (80.0%)\n    Validation: 705 (10.0%)\n    Test: 705 (10.0%)\n\n    Divisi\u00f3n id\u00e9ntica a Fase 2 para comparaci\u00f3n v\u00e1lida.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "RGSE",
      "code_hash": "4fabb5d8dd48f86cf0eb5a07328056b5",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": " Secuencias creadas:\n  - X_train: (5633, 7, 36)\n  - X_val: (698, 7, 36)\n  - X_test: (698, 7, 36)\n  - INPUT_SHAPE: (7, 36)\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "emfo",
      "code_hash": "b30da57dafbb47d92a1835d0f17c1850",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": " Espacio de b\u00fasqueda definido:\n  - Total de combinaciones: 108\n\n Ejemplo de combinaci\u00f3n:\n{\n  \"units\": 32,\n  \"dropout\": 0.1,\n  \"learning_rate\": 0.001,\n  \"batch_size\": 32,\n  \"layer_type\": \"GRU\"\n}\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "nWHF",
      "code_hash": "ed2c9e41370ea18ad780ea316e67153c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": " Funci\u00f3n build_model() definida correctamente.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "ZHCJ",
      "code_hash": "9ba0437d8756aeb9666bf4bd39e02556",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "C:\\Users\\samil\\Desktop\\APRENDIZAJE AUTOMATICO\\PRIMER INTERCICLO\\Practica-2-Aprendizaje-Automactico\\.venv\\Lib\\site-packages\\mlflow\\tracking\\_tracking_service\\utils.py:140: FutureWarning: Filesystem tracking backend (e.g., './mlruns') is deprecated. Please switch to a database backend (e.g., 'sqlite:///mlflow.db'). For feedback, see: https://github.com/mlflow/mlflow/issues/18534\n  return FileStore(store_uri, store_uri)\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": " Iniciando Grid Search...\n  Tiempo estimado: ~216 minutos (aprox.)\n\n\n======================================================================\n Experimento 1/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.001, 'batch_size': 32, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025-11-20 12:32:31.006133: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI AVX_VNNI_INT8 AVX_NE_CONVERT FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\nC:\\Users\\samil\\Desktop\\APRENDIZAJE AUTOMATICO\\PRIMER INTERCICLO\\Practica-2-Aprendizaje-Automactico\\.venv\\Lib\\site-packages\\keras\\src\\layers\\rnn\\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.\n  super().__init__(**kwargs)\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:33:18 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:33:18 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:33:33 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001219 (\u00e9poca 40)\nMejor val_MAE: 0.024203\n  Duraci\u00f3n: 47.4s\n\n======================================================================\n Experimento 2/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.001, 'batch_size': 32, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "C:\\Users\\samil\\Desktop\\APRENDIZAJE AUTOMATICO\\PRIMER INTERCICLO\\Practica-2-Aprendizaje-Automactico\\.venv\\Lib\\site-packages\\keras\\src\\layers\\rnn\\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.\n  super().__init__(**kwargs)\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:34:16 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:34:17 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:34:29 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001240 (\u00e9poca 37)\nMejor val_MAE: 0.024018\n  Duraci\u00f3n: 43.0s\n\n======================================================================\n Experimento 3/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.001, 'batch_size': 64, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:35:00 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:35:00 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:35:12 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001278 (\u00e9poca 50)\nMejor val_MAE: 0.023818\n  Duraci\u00f3n: 30.3s\n\n======================================================================\n Experimento 4/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.001, 'batch_size': 64, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:35:41 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:35:41 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:35:53 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001324 (\u00e9poca 43)\nMejor val_MAE: 0.025140\n  Duraci\u00f3n: 28.7s\n\n======================================================================\n Experimento 5/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0005, 'batch_size': 32, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:36:33 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:36:33 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:36:45 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001255 (\u00e9poca 47)\nMejor val_MAE: 0.023759\n  Duraci\u00f3n: 40.2s\n\n======================================================================\n Experimento 6/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0005, 'batch_size': 32, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:37:23 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:37:23 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:37:34 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001326 (\u00e9poca 46)\nMejor val_MAE: 0.025934\n  Duraci\u00f3n: 38.0s\n\n======================================================================\n Experimento 7/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0005, 'batch_size': 64, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:38:01 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:38:01 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:38:12 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001389 (\u00e9poca 50)\nMejor val_MAE: 0.028116\n  Duraci\u00f3n: 26.6s\n\n======================================================================\n Experimento 8/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0005, 'batch_size': 64, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:38:38 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:38:38 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:38:50 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001480 (\u00e9poca 50)\nMejor val_MAE: 0.027061\n  Duraci\u00f3n: 25.7s\n\n======================================================================\n Experimento 9/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0001, 'batch_size': 32, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:39:36 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:39:36 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:39:48 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001485 (\u00e9poca 49)\nMejor val_MAE: 0.028628\n  Duraci\u00f3n: 45.3s\n\n======================================================================\n Experimento 10/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0001, 'batch_size': 32, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:40:31 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:40:32 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:40:43 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001576 (\u00e9poca 49)\nMejor val_MAE: 0.028622\n  Duraci\u00f3n: 42.8s\n\n======================================================================\n Experimento 11/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0001, 'batch_size': 64, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:41:14 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:41:14 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:41:26 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001626 (\u00e9poca 49)\nMejor val_MAE: 0.028782\n  Duraci\u00f3n: 30.5s\n\n======================================================================\n Experimento 12/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.1, 'learning_rate': 0.0001, 'batch_size': 64, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:41:54 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:41:55 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:42:06 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001718 (\u00e9poca 50)\nMejor val_MAE: 0.031374\n  Duraci\u00f3n: 27.9s\n\n======================================================================\n Experimento 13/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 32, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:42:33 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:42:33 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:42:41 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001268 (\u00e9poca 23)\nMejor val_MAE: 0.024282\n  Duraci\u00f3n: 26.1s\n\n======================================================================\n Experimento 14/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 32, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:43:10 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:43:10 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:43:20 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001343 (\u00e9poca 32)\nMejor val_MAE: 0.025500\n  Duraci\u00f3n: 28.2s\n\n======================================================================\n Experimento 15/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 64, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:43:40 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:43:40 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:43:50 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001353 (\u00e9poca 29)\nMejor val_MAE: 0.026150\n  Duraci\u00f3n: 20.0s\n\n======================================================================\n Experimento 16/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 64, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:44:07 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:44:07 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:44:17 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001392 (\u00e9poca 29)\nMejor val_MAE: 0.025827\n  Duraci\u00f3n: 17.2s\n\n======================================================================\n Experimento 17/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.0005, 'batch_size': 32, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:44:53 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:44:53 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:45:02 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001324 (\u00e9poca 47)\nMejor val_MAE: 0.023237\n  Duraci\u00f3n: 35.6s\n\n======================================================================\n Experimento 18/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.0005, 'batch_size': 32, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:45:36 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:45:36 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:45:45 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001346 (\u00e9poca 50)\nMejor val_MAE: 0.025952\n  Duraci\u00f3n: 33.8s\n\n======================================================================\n Experimento 19/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.0005, 'batch_size': 64, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:46:10 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:46:10 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:46:19 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001420 (\u00e9poca 42)\nMejor val_MAE: 0.027608\n  Duraci\u00f3n: 23.8s\n\n======================================================================\n Experimento 20/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.0005, 'batch_size': 64, 'layer_type': 'LSTM'}\n======================================================================\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:46:41 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:46:42 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "2025/11/20 12:46:51 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Mejor val_loss: 0.001480 (\u00e9poca 50)\nMejor val_MAE: 0.029424\n  Duraci\u00f3n: 21.9s\n\n======================================================================\n Experimento 21/108\n Par\u00e1metros: {'units': 32, 'dropout': 0.2, 'learning_rate': 0.0001, 'batch_size': 32, 'layer_type': 'GRU'}\n======================================================================\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "qnkX",
      "code_hash": "d1a1a814c254cee35c20d4073740c8ee",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Requirement already satisfied: tabulate in c:\\users\\samil\\desktop\\aprendizaje automatico\\primer interciclo\\practica-2-aprendizaje-automactico\\.venv\\lib\\site-packages (0.9.0)\r\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": " tabulate instalado correctamente\n Ahora ejecuta la celda problem\u00e1tica nuevamente\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "TqIu",
      "code_hash": "7083441eb26b269ce102eb87ef869fff",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "DnEU",
      "code_hash": "74b9313cee28dbfe120e67b0d1a5bebb",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "ulZA",
      "code_hash": "32973b6b8377f1a73153c036363eb40b",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Pvdt",
      "code_hash": "eb781bd99c5f5f068825bd8df7cec1c5",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "ZBYS",
      "code_hash": "62ecab350b0af09f4a531f73f89bad5c",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "nHfw",
      "code_hash": "f267329710644cf2fe41085a83c64024",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (ValueError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "pHFh",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    }
  ]
}