<div class="stock-container">
  <button class="csv-button" (click)="subirCsv()">
    <svg class="csv-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
      <polyline points="17 8 12 3 7 8"></polyline>
      <line x1="12" y1="3" x2="12" y2="15"></line>
    </svg>
    <span class="csv-text">Subir CSV</span>
  </button>

  <div class="stock-card">
    <div class="header-section">
      <div class="icon-wrapper">
        <svg class="header-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
          <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
          <line x1="12" y1="22.08" x2="12" y2="12"></line>
        </svg>
      </div>
      <h1 class="title">Predicción de Stock</h1>
      <p class="subtitle">Sistema Inteligente de Gestión de Inventario</p>
    </div>

    <p class="description">
      Ingresa los datos de un producto y obtén predicciones precisas basadas en inteligencia artificial 
      para optimizar tu inventario y maximizar tus ventas.
    </p>

    <div class="input-section">
      <div class="section-header">
        <svg class="section-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <h2>Predicción Individual</h2>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label for="producto">
            <svg class="label-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
              <line x1="7" y1="7" x2="7.01" y2="7"></line>
            </svg>
            Producto
          </label>
          <input 
            id="producto" 
            type="text" 
            placeholder="Ej: Leche Entera 1L" 
            [(ngModel)]="nombre"
            class="input-field"
          />
        </div>

        <div class="form-group">
          <label for="fecha">
            <svg class="label-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            Fecha de Predicción
          </label>
          <input 
            id="fecha" 
            type="date" 
            [(ngModel)]="fecha"
            class="input-field"
          />
        </div>
      </div>

      <button class="btn-primary" (click)="getPedict(fecha, nombre)" [disabled]="cargandoPrediccion">
        <svg *ngIf="!cargandoPrediccion" class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
        </svg>
        <div *ngIf="cargandoPrediccion" class="spinner"></div>
        {{ cargandoPrediccion ? 'Procesando...' : 'Predecir Stock Ahora' }}
      </button>

      <div *ngIf="prediccionResultado" class="prediction-box">
        <div class="prediction-header">
          <svg class="success-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          <h3>Resultado de la Predicción</h3>
        </div>

        <div class="prediction-grid">
          <div class="info-card">
            <span class="info-label">Producto ingresado</span>
            <span class="info-value">{{ prediccionResultado.nombre_ingresado }}</span>
          </div>

          <div class="info-card">
            <span class="info-label">Producto identificado</span>
            <span class="info-value">{{ prediccionResultado.nombre_producto }}</span>
          </div>

          <div class="info-card">
            <span class="info-label">SKU detectado</span>
            <span class="info-value">{{ prediccionResultado.sku_detectado }}</span>
          </div>

          <div class="info-card">
            <span class="info-label">Fecha de predicción</span>
            <span class="info-value">{{ prediccionResultado.fecha_prediccion }}</span>
          </div>
        </div>

        <div class="prediction-result">
          <div class="result-main">
            <span class="result-label">Stock Predicho</span>
            <span class="result-value">
              {{ prediccionResultado.prediction | number:'1.0-2' }}
              <span class="result-unit">unidades</span>
            </span>
          </div>
        </div>

        <div class="recommendation-box">
          <div class="recommendation-header">
            <svg class="bulb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18h6"></path>
              <path d="M10 22h4"></path>
              <path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path>
            </svg>
            <strong>Recomendación</strong>
          </div>
          <p class="recommendation-text">{{ prediccionResultado.mensaje }}</p>
        </div>
      </div>
    </div>

    <hr class="divider" />

    <div class="report-section">
      <div class="section-header">
        <svg class="section-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="20" x2="18" y2="10"></line>
          <line x1="12" y1="20" x2="12" y2="4"></line>
          <line x1="6" y1="20" x2="6" y2="14"></line>
        </svg>
        <h2>Reporte Completo del Inventario</h2>
      </div>
      
      <p class="section-description">
        Genera un reporte detallado con las predicciones de stock para todos los productos de tu inventario.
      </p>

      <div class="report-controls">
        <div class="form-group inline">
          <label for="fechaReporte">
            <svg class="label-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            Selecciona fecha del reporte
          </label>
          <input 
            id="fechaReporte" 
            type="date" 
            [(ngModel)]="fechaReporte"
            class="input-field"
          />
        </div>

        <button class="btn-secondary" (click)="generarReporte()" [disabled]="cargandoReporte">
          <svg *ngIf="!cargandoReporte" class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
          <div *ngIf="cargandoReporte" class="spinner"></div>
          {{ cargandoReporte ? 'Generando...' : 'Generar Reporte Completo' }}
        </button>
      </div>

      <div class="table-wrapper" *ngIf="reporte && reporte.length > 0">
        <div class="table-container">
          <table class="modern-table">
            <thead>
              <tr>
                <th>
                  <div class="th-content">
                    <svg class="th-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                      <line x1="7" y1="7" x2="7.01" y2="7"></line>
                    </svg>
                    Producto
                  </div>
                </th>
                <th>
                  <div class="th-content">
                    <svg class="th-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                      <line x1="16" y1="2" x2="16" y2="6"></line>
                      <line x1="8" y1="2" x2="8" y2="6"></line>
                      <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    Fecha
                  </div>
                </th>
                <th>
                  <div class="th-content">
                    <svg class="th-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                    </svg>
                    Predicción
                  </div>
                </th>
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let item of reporte; let i = index" class="table-row">
                <td class="product-cell">{{ item.nombre }}</td>
                <td class="date-cell">{{ fechaReporte }}</td>
                <td class="prediction-cell">
                  <span class="badge">{{ item.prediction | number:'1.0-2' }} unidades</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <p *ngIf="mensajeResumen" class="mensaje-resumen">
        <svg class="summary-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        {{ mensajeResumen }}
      </p>
    </div>
  </div>
</div>