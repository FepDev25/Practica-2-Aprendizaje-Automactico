<div class="chat-container">
  <!-- Header del Chat -->
  <div class="chat-header">
    <div class="header-left">
      <div class="bot-icon-wrapper">
        <svg class="bot-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
          stroke-width="2">
          <rect x="3" y="11" width="18" height="10" rx="2" ry="2"></rect>
          <circle cx="12" cy="5" r="2"></circle>
          <path d="M12 7v4"></path>
        </svg>
        <span class="status-dot"></span>
      </div>
      <div class="header-info">
        <h2>Asistente IA</h2>
        <span class="status-text">En lÃ­nea</span>
      </div>
    </div>

    <div class="header-actions">
      <button class="action-btn" title="Limpiar chat" (click)="clearChat()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
      </button>
      <button class="action-btn" title="ConfiguraciÃ³n">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 1v6m0 6v6m8.66-9.66l-5.2 3M8.54 14l-5.2 3M21 12h-6m-6 0H3m17.66 4.34l-5.2-3M8.54 10l-5.2-3">
          </path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Ãrea de Mensajes -->
  <div class="messages-area">
    <div class="messages-scroll" #messagesScroll>
      <!-- Mensaje de Bienvenida -->
      <div class="welcome-card" *ngIf="messages.length === 0">
        <div class="welcome-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <path
              d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
            </path>
          </svg>
        </div>
        <h3>Â¡Hola! ğŸ‘‹</h3>
        <p>Soy tu asistente inteligente de inventario. PregÃºntame sobre predicciones, anÃ¡lisis o recomendaciones para
          optimizar tu stock.</p>
      </div>

      <!-- Sugerencias RÃ¡pidas -->
      <div class="suggestions-container" *ngIf="messages.length === 0">
        <span class="suggestions-label">Preguntas sugeridas:</span>
        <div class="suggestion-chips">
          <button class="suggestion-chip" (click)="chat('Â¿QuÃ© productos tienen stock bajo?')">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            Â¿QuÃ© productos tienen stock bajo?
          </button>
          <button class="suggestion-chip" (click)="chat('MuÃ©strame las tendencias')">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
            MuÃ©strame las tendencias
          </button>
          <button class="suggestion-chip" (click)="chat('Dame recomendaciones')">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2">
              <path d="M9 18h6"></path>
              <path d="M10 22h4"></path>
              <path
                d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14">
              </path>
            </svg>
            Dame recomendaciones
          </button>
        </div>
      </div>

      <!-- Ejemplo de Mensaje del Bot (solo si no hay mensajes) -->
      <div class="message bot-message" *ngIf="messages.length === 0">
        <div class="message-avatar">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <rect x="3" y="11" width="18" height="10" rx="2" ry="2"></rect>
            <circle cx="12" cy="5" r="2"></circle>
            <path d="M12 7v4"></path>
          </svg>
        </div>
        <div class="message-bubble">
          <div class="message-text">
            <p>Estoy listo para ayudarte. Puedes preguntarme sobre:</p>
            <ul class="message-list">
              <li>ğŸ“Š Predicciones de stock por producto</li>
              <li>ğŸ“ˆ AnÃ¡lisis de tendencias de inventario</li>
              <li>âš ï¸ Alertas de productos crÃ­ticos</li>
              <li>ğŸ’¡ Recomendaciones de reabastecimiento</li>
            </ul>
          </div>
          <span class="message-time">Justo ahora</span>
        </div>
      </div>

      <!-- Mensajes DinÃ¡micos del Chat -->
      <div *ngFor="let msg of messages"
        [ngClass]="msg.from === 'user' ? 'message user-message' : 'message bot-message'">

        <!-- Avatar del BOT (aparece a la izquierda) -->
        <div class="message-avatar" *ngIf="msg.from === 'bot'">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <rect x="3" y="11" width="18" height="10" rx="2" ry="2"></rect>
            <circle cx="12" cy="5" r="2"></circle>
            <path d="M12 7v4"></path>
          </svg>
        </div>

        <!-- Burbuja del Mensaje -->
        <div class="message-bubble">
          <div class="message-text">
            <p>{{ msg.text }}</p>
          </div>
          <span class="message-time">{{ msg.time | date:'shortTime' }}</span>
        </div>

        <!-- Avatar del USUARIO (aparece a la derecha) -->
        <div class="message-avatar user-avatar" *ngIf="msg.from === 'user'">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
      </div>
    </div>
  </div>

  <!-- Input de Mensaje -->
  <div class="input-area">
    <div class="input-wrapper">
      <button class="attach-btn" title="Adjuntar archivo">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path
            d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
          </path>
        </svg>
      </button>

      <input type="text" class="message-input" placeholder="Escribe tu pregunta aquÃ­..." autocomplete="off"
        [(ngModel)]="message" (keydown.enter)="chat(message)" />

      <button class="emoji-btn" title="Emojis">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
          <line x1="9" y1="9" x2="9.01" y2="9"></line>
          <line x1="15" y1="9" x2="15.01" y2="9"></line>
        </svg>
      </button>

      <button class="send-btn" title="Enviar mensaje" (click)="chat(message)">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" />
        </svg>
      </button>
    </div>
  </div>
</div>